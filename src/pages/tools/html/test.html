<div class="card-base rounded-xl p-6 text-gray-900 dark:text-gray-100">
  <h2 class="text-xl font-bold mb-4">测试工具</h2>
  <p class="text-base-content/70">可以在下方输入文本，没有任何作用，<em>除非表现得完美无瑕...</em></p>

  <input id="txt" class="input input-bordered w-full mt-4" placeholder="轻触以键入文本...">
</div>

<script>
const UNLOCK_CODE = "Pictured as Perfect";
const RESET_CODE = "Therefore never perfect";
// <em>　　　除非是她的无瑕妙笔...</em>

/** 绑定解锁/重置逻辑（可重复调用） */
function bindUnlock() {
  const input = document.getElementById('txt');
  if (!input) return;
  input.removeEventListener('input', handleUnlock); // 防重复
  input.addEventListener('input', handleUnlock);
}

function handleUnlock(e) {
  const val = e.target.value;
  if (val === UNLOCK_CODE) {
    localStorage.setItem('UNLOCKED_CARDS', JSON.stringify(['secret-tool']));
    alert('Pictured as Perfect.');
    setTimeout(() => window.location.href = '/tools/', 1200);
  } else if (val === RESET_CODE) {
    localStorage.removeItem('UNLOCKED_CARDS');
    alert('Unlock has been reset.');
    setTimeout(() => window.location.href = '/tools/', 1200);
  }
}

// 首次绑定
bindUnlock();

// Swup 导航回来后重新绑定
if (window.swup) {
  window.addEventListener('swup:contentReplaced', bindUnlock);
}
</script>